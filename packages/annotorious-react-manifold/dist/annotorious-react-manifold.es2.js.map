{"version":3,"file":"annotorious-react-manifold.es2.js","sources":["../src/openseadragon/OpenSeadragonViewer.tsx"],"sourcesContent":["import { useContext, useEffect } from 'react';\nimport { OSDViewerContext } from './OpenSeadragonViewerManifold';\nimport { \n  OpenSeadragonViewer as OpenSeadragonViewerInstance, \n  OpenSeadragonViewerProps as OpenSeadragonViewerInstanceProps, \n  useViewer \n} from '@annotorious/react';\n\n/** Passes the OSD viewer instance upwards to the manifold **/\nconst OpenSeadragonViewerInstanceShim = (props: { id: string }) => {\n\n  const viewer = useViewer();\n\n  const { setViewers } = useContext(OSDViewerContext);\n\n  useEffect(() => {\n    if (viewer) {\n      setViewers(m => new Map(m.entries()).set(props.id, viewer));\n\n      return () => {\n        setViewers(m => new Map(Array.from(m.entries()).filter(([key, _]) => key !== props.id)));\n      }\n    }\n  }, [viewer]);\n\n  return null;\n\n}\n\ntype OpenSeadragonViewerProps = OpenSeadragonViewerInstanceProps & {\n\n  id: string\n\n};\n\n/**\n * An alternative <OpenSeadragonViewer /> component that mimicks the original\n * from @annotorious/react, but injects a shim component that connects\n * the Viewer to the ViewerManifold.\n */\nexport const OpenSeadragonViewer = (props: OpenSeadragonViewerProps) => {\n\n  return (\n    <>\n      <OpenSeadragonViewerInstance {...props} />\n      <OpenSeadragonViewerInstanceShim id={props.id} />\n    </>\n  )\n\n}"],"names":["OpenSeadragonViewerInstanceShim","props","viewer","useViewer","setViewers","useContext","OSDViewerContext","useEffect","m","key","_","OpenSeadragonViewer","jsxs","Fragment","jsx","OpenSeadragonViewerInstance"],"mappings":";;;;AASA,MAAMA,IAAkC,CAACC,MAA0B;AAEjE,QAAMC,IAASC,KAET,EAAE,YAAAC,EAAA,IAAeC,EAAWC,CAAgB;AAElD,SAAAC,EAAU,MAAM;AACd,QAAIL;AACS,aAAAE,EAAA,CAAAI,MAAK,IAAI,IAAIA,EAAE,SAAS,EAAE,IAAIP,EAAM,IAAIC,CAAM,CAAC,GAEnD,MAAM;AACX,QAAAE,EAAW,OAAK,IAAI,IAAI,MAAM,KAAKI,EAAE,QAAS,CAAA,EAAE,OAAO,CAAC,CAACC,GAAKC,CAAC,MAAMD,MAAQR,EAAM,EAAE,CAAC,CAAC;AAAA,MAAA;AAAA,EAE3F,GACC,CAACC,CAAM,CAAC,GAEJ;AAET,GAaaS,IAAsB,CAACV,MAI9BW,gBAAAA,EAAA,KAAAC,YAAA,EAAA,UAAA;AAAA,EAACC,gBAAAA,EAAAA,IAAAC,GAAA,EAA6B,GAAGd,GAAO;AAAA,EACvCa,gBAAAA,EAAAA,IAAAd,GAAA,EAAgC,IAAIC,EAAM,GAAI,CAAA;AACjD,EAAA,CAAA;"}